<h1>Sessions for {{ booking.student.full_name }} with {{ booking.tutor.full_name }} ({{ booking.term }})</h1>

<!-- Filter and Order Form -->
<form method="get">
    <label for="type">Filter by Type:</label>
    <select name="type" id="type">
        <option value="">All</option>
        {% for value, label in lesson_type_choices %}
        <option value="{{ value }}" {% if request.GET.type == value %}selected{% endif %}>
            {{ label }}
        </option>
        {% endfor %}
    </select>

    <label for="venue">Filter by Venue:</label>
    <select name="venue" id="venue">
        <option value="">All</option>
        {% for value, label in venue_choices %}
        <option value="{{ value }}" {% if request.GET.venue == value %}selected{% endif %}>
            {{ label }}
        </option>
        {% endfor %}
    </select>

    <label for="payment">Filter by Payment Status:</label>
    <select name="payment" id="payment">
        <option value="">All</option>
        {% for value, label in payment_status_choices %}
        <option value="{{ value }}" {% if request.GET.payment == value %}selected{% endif %}>
            {{ label }}
        </option>
        {% endfor %}
    </select>

    <label for="order">Order by Date:</label>
    <select name="order" id="order">
        <option value="">Default</option>
        <option value="closest" {% if request.GET.order == "closest" %}selected{% endif %}>
            Closest
        </option>
        <option value="furthest" {% if request.GET.order == "furthest" %}selected{% endif %}>
            Furthest
        </option>
    </select>

    <button type="submit">Apply</button>
</form>

<a href="{% url 'session_create' booking.id %}"><button>Create Session</button></a>

{% if sessions %}
    <table>
        <tr>
            <th>Date</th>
            <th>Time</th>
            <th>Duration</th>
            <th>Type</th>
            <th>Venue</th>
            <th>Amount</th>
            <th>Payment</th>
            <th>Actions</th>
        </tr>
        {% for session in sessions %}
        <tr>
            <td>{{ session.session_date|date:"d/m/Y" }}</td>
            <td>{{ session.session_time|time:"H:i" }}</td>
            <td>{{ session.duration }}</td>
            <td>{{ session.lesson_type }}</td>
            <td>{{ session.venue }}</td>
            <td>${{ session.amount }}</td>
            <td>{{ session.payment_status }}</td>
            <td>
                <a href="{% url 'session_update' session.id %}"><button>Update</button></a>
                <a href="{% url 'session_delete' session.id %}"><button>Delete</button></a>
            </td>
        </tr>
        {% endfor %}
    </table>
{% else %}
    <p>No sessions available.</p>
{% endif %}
<a href="{% url 'booking_list' %}"><button>Back to Bookings</button></a>
